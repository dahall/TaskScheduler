<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>netstandard2.0;netcoreapp2.0;netcoreapp2.1;net20;net35;net40;net45</TargetFrameworks>
    <AssemblyName>Microsoft.Win32.TaskScheduler</AssemblyName>
    <RootNamespace>Microsoft.Win32.TaskScheduler</RootNamespace>
    <SignAssembly>true</SignAssembly>
    <AssemblyOriginatorKeyFile>TaskService.snk</AssemblyOriginatorKeyFile>
    <DelaySign>false</DelaySign>
    <PackageId>TaskScheduler</PackageId>
    <Version>3.0.0</Version>
    <Title>Task Scheduler Managed Wrapper</Title>
    <Authors>David Hall</Authors>
    <Company>GitHub Community</Company>
    <Description>Provides a single assembly wrapper for the 1.0 and 2.0 versions of Task Scheduler found in all Microsoft operating systems post Windows 98. It simplifies the coding, aggregates the multiple versions and allows for localization support.</Description>
    <NeutralLanguage>en-US</NeutralLanguage>
    <Copyright>Copyright © 2017</Copyright>
    <PackageLicenseUrl>https://github.com/dahall/TaskScheduler/blob/master/license.md</PackageLicenseUrl>
    <PackageProjectUrl>https://github.com/dahall/taskscheduler</PackageProjectUrl>
    <PackageIconUrl>https://github.com/dahall/TaskScheduler/blob/master/docs/icons/tsnew48.png?raw=true</PackageIconUrl>
    <RepositoryUrl>https://github.com/dahall/taskscheduler</RepositoryUrl>
    <RepositoryType>Git</RepositoryType>
    <PackageTags>task;interop;taskscheduler</PackageTags>
    <IncludeSymbols>true</IncludeSymbols>
    <IncludeSource>true</IncludeSource>
    <LangVersion>latest</LangVersion>
    <DocumentationFile>bin\$(Configuration)\$(TargetFramework)\Microsoft.Win32.TaskScheduler.xml</DocumentationFile>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)'=='Release'">
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>
  </PropertyGroup>
  <ItemGroup>
    <Compile Remove="Native\**" />
    <Compile Remove="V1\**" />
    <Compile Remove="V2\**" />
    <EmbeddedResource Remove="Native\**" />
    <EmbeddedResource Remove="V1\**" />
    <EmbeddedResource Remove="V2\**" />
    <None Remove="Native\**" />
    <None Remove="V1\**" />
    <None Remove="V2\**" />
  </ItemGroup>
  <ItemGroup>
    <Compile Remove="ReflectionHelper.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Remove="TaskService.bmp" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Native\AccessControlExtension.cs" />
    <Compile Include="Native\NTDSAPI.cs" />
    <Compile Include="Native\WindowsImpersonatedIdentity.cs" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="TaskService.bmp" />
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'netstandard2.0' Or '$(TargetFramework)' == 'netcoreapp2.0' Or '$(TargetFramework)' == 'netcoreapp2.1'">
    <PackageReference Include="Microsoft.Win32.Registry" Version="4.5.0" />
    <PackageReference Include="System.Reflection" Version="4.3.0" />
    <PackageReference Include="System.Runtime.Serialization.Formatters" Version="4.3.0" />
    <PackageReference Include="System.Security.AccessControl" Version="4.5.0" />
    <PackageReference Include="System.Security.Permissions" Version="4.5.0" />
    <PackageReference Include="System.Security.Principal.Windows" Version="4.5.1" />
    <PackageReference Include="System.Xml.XmlSerializer" Version="4.3.0" />
    <PackageReference Include="Vanara.Compatibility.EventLog" Version="1.0.1" />
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'net20' ">
    <Reference Include="System.Drawing" />
    <Reference Include="System" />
    <PackageReference Include="Vanara.Compatibility.EventLog" Version="1.0.1" />
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'net35' ">
    <Reference Include="System.Drawing" />
    <Reference Include="System" />
    <Reference Include="WindowsBase">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.0\WindowsBase.dll</HintPath>
    </Reference>
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'net40' ">
    <Reference Include="System.Drawing" />
    <Reference Include="System" />
    <Reference Include="Microsoft.CSharp" />
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'net45' ">
    <Reference Include="System.Drawing" />
    <Reference Include="System" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.IO.Compression" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="V1\TaskSchedulerV1Schema.xsd" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Vanara.PInvoke.NTDSApi" Version="2.1.1" />
    <PackageReference Include="Vanara.PInvoke.Security" Version="2.1.1" />
    <PackageReference Include="Vanara.PInvoke.TaskSchd" Version="2.1.1" />
  </ItemGroup>
  <ItemGroup>
    <Compile Update="Properties\Resources.Designer.cs">
      <DesignTime>True</DesignTime>
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Update="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <EmbeddedResource Update="Properties\Resources.ru.resx">
      <Generator>ResXFileCodeGenerator</Generator>
    </EmbeddedResource>
  </ItemGroup>
</Project>