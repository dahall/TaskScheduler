<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TaskSecurity Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="TaskSecurity class" /><meta name="System.Keywords" content="Microsoft.Win32.TaskScheduler.TaskSecurity class" /><meta name="System.Keywords" content="TaskSecurity class, about TaskSecurity class" /><meta name="Microsoft.Help.F1" content="Microsoft.Win32.TaskScheduler.TaskSecurity" /><meta name="Microsoft.Help.Id" content="T:Microsoft.Win32.TaskScheduler.TaskSecurity" /><meta name="Description" content="Represents the Windows access control security for a Task Scheduler task. This class cannot be inherited." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="T_Microsoft_Win32_TaskScheduler_TaskSecurity" /><meta name="guid" content="T_Microsoft_Win32_TaskScheduler_TaskSecurity" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Overview" tocid="R_Project_TaskScheduler">Overview</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Class" tocid="T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor.htm" title="TaskSecurity Constructor " tocid="Overload_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor">TaskSecurity Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Properties_T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Properties" tocid="Properties_T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="Task Scheduler Managed Class Library" width="48" height="48" src="../icons/tsnew48.png" /></td><td class="titleColumn"><h1>TaskSecurity Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Represents the Windows access control security for a Task Scheduler task. This class cannot be inherited.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST56B0D541_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <a href="http://msdn2.microsoft.com/en-us/library/dx9x909h" target="_blank">System.Security.AccessControl<span id="LST56B0D541_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ObjectSecurity</a><br />    <a href="http://msdn2.microsoft.com/en-us/library/2z9wa9db" target="_blank">System.Security.AccessControl<span id="LST56B0D541_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CommonObjectSecurity</a><br />      <span class="selflink">Microsoft.Win32.TaskScheduler<span id="LST56B0D541_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskSecurity</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br />
    <strong>Assembly:</strong>
   Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.7.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','cs','1','3');return false;">C#</a></div><div id="ID1ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','vb','2','3');return false;">VB</a></div><div id="ID1ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID1ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="identifier">TaskSecurity</span> : <span class="identifier">CommonObjectSecurity</span></pre></div><div id="ID1ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">NotInheritable</span> <span class="keyword">Class</span> <span class="identifier">TaskSecurity</span>
	<span class="keyword">Inherits</span> <span class="identifier">CommonObjectSecurity</span></pre></div><div id="ID1ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">TaskSecurity</span> <span class="keyword">sealed</span> : <span class="keyword">public</span> <span class="identifier">CommonObjectSecurity</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1ECCA");</script><a id="HT_RequestExampleLink" href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
		var HT_requestExampleLinkText = HT_requestExampleLink.innerHTML;
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=Task Scheduler Managed Class Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		HT_requestExampleLink.innerHTML = HT_requestExampleLinkText;
		</script><a target="_blank" class="button" href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/TaskSecurity.cs" title="View the source code">View Source</a></div><p>The <span class="selflink">TaskSecurity</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor.htm">TaskSecurity<span id="LST56B0D541_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_4?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a></td><td><div class="summary">
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with default values.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor_1.htm">TaskSecurity(Task, AccessControlSections)</a></td><td><div class="summary">
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with the specified sections of the access control security rules from the specified task.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor_2.htm">TaskSecurity(TaskFolder, AccessControlSections)</a></td><td><div class="summary">
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with the specified sections of the access control security rules from the specified task.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="propertyList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRightType.htm">AccessRightType</a></td><td><div class="summary">
            Gets the enumeration that the <span class="selflink">TaskSecurity</span> class uses to represent access rights.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/ms147875" target="_blank">ObjectSecurity<span id="LST56B0D541_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AccessRightType</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRuleType.htm">AccessRuleType</a></td><td><div class="summary">
            Gets the type that the TaskSecurity class uses to represent access rules.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/ms147876" target="_blank">ObjectSecurity<span id="LST56B0D541_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AccessRuleType</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AuditRuleType.htm">AuditRuleType</a></td><td><div class="summary">
            Gets the type that the TaskSecurity class uses to represent audit rules.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/ms147879" target="_blank">ObjectSecurity<span id="LST56B0D541_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AuditRuleType</a>.)</td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_DefaultTaskSecurity.htm">DefaultTaskSecurity</a></td><td><div class="summary">
            Gets a <span class="selflink">TaskSecurity</span> object that represent the default access rights.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID5RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRuleFactory.htm">AccessRuleFactory</a></td><td><div class="summary">
            Creates a new access control rule for the specified user, with the specified access rights, access control, and flags.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/ms147859" target="_blank">ObjectSecurity<span id="LST56B0D541_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AccessRuleFactory(IdentityReference, Int32, Boolean, InheritanceFlags, PropagationFlags, AccessControlType)</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AddAccessRule.htm">AddAccessRule</a></td><td><div class="summary">
            Searches for a matching rule with which the new rule can be merged. If none are found, adds the new rule.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AddAuditRule.htm">AddAuditRule</a></td><td><div class="summary">
            Searches for an audit rule with which the new rule can be merged. If none are found, adds the new rule.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AuditRuleFactory.htm">AuditRuleFactory</a></td><td><div class="summary">
            Creates a new audit rule, specifying the user the rule applies to, the access rights to audit, and the outcome that triggers the audit rule.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/ms147860" target="_blank">ObjectSecurity<span id="LST56B0D541_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AuditRuleFactory(IdentityReference, Int32, Boolean, InheritanceFlags, PropagationFlags, AuditFlags)</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/bsc2ak47" target="_blank">Equals</a></td><td><div class="summary">Determines whether the specified object is equal to the current object.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/4k87zsw7" target="_blank">Finalize</a></td><td><div class="summary">Allows an object to try to free resources and perform other cleanup operations before it is reclaimed by garbage collection.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/zdee4b3y" target="_blank">GetHashCode</a></td><td><div class="summary">Serves as the default hash function. </div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/dfwy45w9" target="_blank">GetType</a></td><td><div class="summary">Gets the <a href="http://msdn2.microsoft.com/en-us/library/42892f65" target="_blank">Type</a> of the current instance.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/57ctke0a" target="_blank">MemberwiseClone</a></td><td><div class="summary">Creates a shallow copy of the current <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;declared;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_Persist.htm">Persist</a></td><td><div class="summary">
            Saves the specified sections of the security descriptor associated with this <a href="http://msdn2.microsoft.com/en-us/library/dx9x909h" target="_blank">ObjectSecurity</a> object to permanent storage. We recommend that the values of the <span class="parameter">includeSections</span> parameters passed to the constructor and persist methods be identical. For more information, see Remarks.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/790xed2a" target="_blank">ObjectSecurity<span id="LST56B0D541_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Persist(String, AccessControlSections)</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRule.htm">RemoveAccessRule</a></td><td><div class="summary">
            Searches for an access control rule with the same user and <a href="http://msdn2.microsoft.com/en-us/library/w4ds5h86" target="_blank">AccessControlType</a> (allow or deny) as the specified rule, and with compatible inheritance and propagation flags; if such a rule is found, the rights contained in the specified access rule are removed from it.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRuleAll.htm">RemoveAccessRuleAll</a></td><td><div class="summary">
            Searches for all access control rules with the same user and <a href="http://msdn2.microsoft.com/en-us/library/w4ds5h86" target="_blank">AccessControlType</a> (allow or deny) as the specified rule and, if found, removes them.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRuleSpecific.htm">RemoveAccessRuleSpecific</a></td><td><div class="summary">
            Searches for an access control rule that exactly matches the specified rule and, if found, removes it.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRule.htm">RemoveAuditRule</a></td><td><div class="summary">
            Searches for an audit control rule with the same user as the specified rule, and with compatible inheritance and propagation flags; if a compatible rule is found, the rights contained in the specified rule are removed from it.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRuleAll.htm">RemoveAuditRuleAll</a></td><td><div class="summary">
            Searches for all audit rules with the same user as the specified rule and, if found, removes them.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRuleSpecific.htm">RemoveAuditRuleSpecific</a></td><td><div class="summary">
            Searches for an audit rule that exactly matches the specified rule and, if found, removes it.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_ResetAccessRule.htm">ResetAccessRule</a></td><td><div class="summary">
            Removes all access control rules with the same user as the specified rule, regardless of <a href="http://msdn2.microsoft.com/en-us/library/w4ds5h86" target="_blank">AccessControlType</a>, and then adds the specified rule.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_SetAccessRule.htm">SetAccessRule</a></td><td><div class="summary">
            Removes all access control rules with the same user and <a href="http://msdn2.microsoft.com/en-us/library/w4ds5h86" target="_blank">AccessControlType</a> (allow or deny) as the specified rule, and then adds the specified rule.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_SetAuditRule.htm">SetAuditRule</a></td><td><div class="summary">
            Removes all audit rules with the same user as the specified rule, regardless of the <a href="http://msdn2.microsoft.com/en-us/library/h2kfawd3" target="_blank">AuditFlags</a> value, and then adds the specified rule.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_ToString.htm">ToString</a></td><td><div class="summary">
            Returns a <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a> that represents this instance.
            </div> (Overrides <a href="http://msdn2.microsoft.com/en-us/library/7bxwbwt2" target="_blank">Object<span id="LST56B0D541_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ToString<span id="LST56B0D541_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_12?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>.)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID6RBSection" class="collapsibleSection"><p>A TaskSecurity object specifies access rights for a Task Scheduler task, and also specifies how access attempts are audited. Access rights to the task are expressed as rules, with each access rule represented by a <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a> object. Each auditing rule is represented by a <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> object.</p><p>This mirrors the underlying Windows security system, in which each securable object has at most one discretionary access control list (DACL) that controls access to the secured object, and at most one system access control list (SACL) that specifies which access attempts are audited. The DACL and SACL are ordered lists of access control entries (ACE) that specify access and auditing for users and groups. A <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a> or <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> object might represent more than one ACE.</p><p>Note</p><p>A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> object can represent a local task or a Task Scheduler task. Windows access control security is meaningful only for Task Scheduler tasks.</p><p>The TaskSecurity, <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a>, and <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> classes hide the implementation details of ACLs and ACEs. They allow you to ignore the seventeen different ACE types and the complexity of correctly maintaining inheritance and propagation of access rights. These objects are also designed to prevent the following common access control errors:</p><ul><li>Creating a security descriptor with a null DACL. A null reference to a DACL allows any user to add access rules to an object, potentially creating a denial-of-service attack. A new TaskSecurity object always starts with an empty DACL, which denies all access for all users.</li><li>Violating the canonical ordering of ACEs. If the ACE list in the DACL is not kept in the canonical order, users might inadvertently be given access to the secured object. For example, denied access rights must always appear before allowed access rights. TaskSecurity objects maintain the correct order internally. </li><li>Manipulating security descriptor flags, which should be under resource manager control only.</li><li>Creating invalid combinations of ACE flags.</li><li>Manipulating inherited ACEs. Inheritance and propagation are handled by the resource manager, in response to changes you make to access and audit rules.</li><li>Inserting meaningless ACEs into ACLs.</li></ul><p>The only capabilities not supported by the .NET security objects are dangerous activities that should be avoided by the majority of application developers, such as the following:</p><ul><li>Low-level tasks that are normally performed by the resource manager.</li><li>Adding or removing access control entries in ways that do not maintain the canonical ordering.</li></ul><p>To modify Windows access control security for a task, use the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetAccessControl.htm">GetAccessControl<span id="LST56B0D541_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_13?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a> method to get the TaskSecurity object. Modify the security object by adding and removing rules, and then use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method to reattach it. </p><p>Important: Changes you make to a TaskSecurity object do not affect the access levels of the task until you call the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method to assign the altered security object to the task.</p><p>To copy access control security from one task to another, use the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetAccessControl.htm">GetAccessControl<span id="LST56B0D541_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST56B0D541_14?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a> method to get a TaskSecurity object representing the access and audit rules for the first task, then use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method, or a constructor that accepts a TaskSecurity object, to assign those rules to the second task.</p><p>Users with an investment in the security descriptor definition language (SDDL) can use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetSecurityDescriptorSddlForm.htm">SetSecurityDescriptorSddlForm(String, TaskSetSecurityOptions)</a> method to set access rules for a task, and the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetSecurityDescriptorSddlForm.htm">GetSecurityDescriptorSddlForm(SecurityInfos)</a> method to obtain a string that represents the access rules in SDDL format. This is not recommended for new development.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID7RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank">© 2017 GitHub Community. All rights reserved.</a></p> </div></body></html>