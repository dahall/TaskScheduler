<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>TaskSecurity Class</title><meta name="Title" content="TaskSecurity Class" /><meta name="Microsoft.Help.Id" content="T:Microsoft.Win32.TaskScheduler.TaskSecurity" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Microsoft.Win32.TaskScheduler.TaskSecurity class" /><meta name="System.Keywords" content="TaskSecurity class" /><meta name="Microsoft.Help.F1" content="Microsoft.Win32.TaskScheduler.TaskSecurity" /><meta name="Microsoft.Help.F1" content="TaskSecurity" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="T_Microsoft_Win32_TaskScheduler_TaskSecurity" /><meta name="guid" content="T_Microsoft_Win32_TaskScheduler_TaskSecurity" /><meta name="Description" content="Represents the Windows access control security for a Task Scheduler task. This class cannot be inherited." /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library Overview" tocid="R_Project_TaskScheduler">Task Scheduler Managed Class Library Overview</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Class" tocid="T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor.htm" title="TaskSecurity Constructor" tocid="Overload_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor">TaskSecurity Constructor</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Properties_T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Properties" tocid="Properties_T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Microsoft_Win32_TaskScheduler_TaskSecurity.htm" title="TaskSecurity Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_TaskSecurity">TaskSecurity Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="logoColumn"><a target="_blank" rel="noopener noreferrer" href="https://github.com/dahall/TaskScheduler"><img alt="Task Scheduler Managed Class Library" width="48" height="48" src="../icons/tsnew48.png" /></a></td><td class="titleColumn"><h1>Task<wbr />Security Class</h1></td></tr></table><div class="summary">
            Represents the Windows access control security for a Task Scheduler task. This class cannot be inherited.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEA')" onkeypress="SectionExpandCollapse_CheckKey('IDEA', event)" tabindex="0"><img id="IDEAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDEASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LST56B0D541_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity" target="_blank" rel="noopener noreferrer">System.Security.AccessControl<span id="LST56B0D541_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>ObjectSecurity</a><br />    <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.commonobjectsecurity" target="_blank" rel="noopener noreferrer">System.Security.AccessControl<span id="LST56B0D541_2" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>CommonObjectSecurity</a><br />      <span class="selflink">Microsoft.Win32.TaskScheduler<span id="LST56B0D541_3" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>TaskSecurity</span><br /></div><br /><strong>Namespace:</strong> <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br /><strong>Assembly:</strong> Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.12.1<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="identifier">TaskSecurity</span> : <span class="identifier">CommonObjectSecurity</span></pre></div></div></div><a id="HT_RequestExampleLink" href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" rel="noopener noreferrer" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=Task%20Scheduler%20Managed%20Class%20Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		</script><a target="_blank" class="button" href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/TaskSecurity.cs" rel="noopener noreferrer" title="View the source code">View Source</a></div><p>The <span class="selflink">TaskSecurity</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAAFA', event)" tabindex="0"><img id="IDAAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="IDAAFASection" class="collapsibleSection"><table id="ConstructorList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor.htm">TaskSecurity<span id="LST56B0D541_4" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with default values.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor_1.htm">TaskSecurity(Task, AccessControlSections)</a></td><td>
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with the specified sections of the access control security rules from the specified task.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity__ctor_2.htm">TaskSecurity(TaskFolder, AccessControlSections)</a></td><td>
            Initializes a new instance of the <span class="selflink">TaskSecurity</span> class with the specified sections of the access control security rules from the specified task.
            </td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDVFA')" onkeypress="SectionExpandCollapse_CheckKey('IDVFA', event)" tabindex="0"><img id="IDVFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDVFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRightType.htm">AccessRightType</a></td><td>
            Gets the enumeration that the <span class="selflink">TaskSecurity</span> class uses to represent access rights.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.accessrighttype" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_5" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AccessRightType</a>)</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRuleType.htm">AccessRuleType</a></td><td>
            Gets the type that the TaskSecurity class uses to represent access rules.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.accessruletype" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_6" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AccessRuleType</a>)</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_AuditRuleType.htm">AuditRuleType</a></td><td>
            Gets the type that the TaskSecurity class uses to represent audit rules.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.auditruletype" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_7" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AuditRuleType</a>)</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Microsoft_Win32_TaskScheduler_TaskSecurity_DefaultTaskSecurity.htm">DefaultTaskSecurity</a></td><td>
            Gets a <span class="selflink">TaskSecurity</span> object that represent the default access rights.
            </td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBFA')" onkeypress="SectionExpandCollapse_CheckKey('IDBFA', event)" tabindex="0"><img id="IDBFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDBFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AccessRuleFactory.htm">AccessRuleFactory</a></td><td>
            Creates a new access control rule for the specified user, with the specified access rights, access control, and flags.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.accessrulefactory" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_8" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AccessRuleFactory(IdentityReference, Int32, Boolean, InheritanceFlags, PropagationFlags, AccessControlType)</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AddAccessRule.htm">AddAccessRule</a></td><td>
            Searches for a matching rule with which the new rule can be merged. If none are found, adds the new rule.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AddAuditRule.htm">AddAuditRule</a></td><td>
            Searches for an audit rule with which the new rule can be merged. If none are found, adds the new rule.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_AuditRuleFactory.htm">AuditRuleFactory</a></td><td>
            Creates a new audit rule, specifying the user the rule applies to, the access rights to audit, and the outcome that triggers the audit rule.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.auditrulefactory" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_9" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AuditRuleFactory(IdentityReference, Int32, Boolean, InheritanceFlags, PropagationFlags, AuditFlags)</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/protMethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.finalize" target="_blank" rel="noopener noreferrer">Finalize</a></td><td>Allows an object to try to free resources and perform other cleanup operations before it is reclaimed by garbage collection.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/protMethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone" target="_blank" rel="noopener noreferrer">MemberwiseClone</a></td><td>Creates a shallow copy of the current <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/protMethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_Persist.htm">Persist</a></td><td>
            Saves the specified sections of the security descriptor associated with this <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity" target="_blank" rel="noopener noreferrer">ObjectSecurity</a> object to permanent storage. We recommend that the values of the <span class="parameter">includeSections</span> parameters passed to the constructor and persist methods be identical. For more information, see Remarks.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.objectsecurity.persist#system-security-accesscontrol-objectsecurity-persist(system-string-system-security-accesscontrol-accesscontrolsections)" target="_blank" rel="noopener noreferrer">ObjectSecurity<span id="LST56B0D541_10" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Persist(String, AccessControlSections)</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRule.htm">RemoveAccessRule</a></td><td>
            Searches for an access control rule with the same user and <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.accesscontroltype" target="_blank" rel="noopener noreferrer">AccessControlType</a> (allow or deny) as the specified rule, and with compatible inheritance and propagation flags; if such a rule is found, the rights contained in the specified access rule are removed from it.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRuleAll.htm">RemoveAccessRuleAll</a></td><td>
            Searches for all access control rules with the same user and <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.accesscontroltype" target="_blank" rel="noopener noreferrer">AccessControlType</a> (allow or deny) as the specified rule and, if found, removes them.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAccessRuleSpecific.htm">RemoveAccessRuleSpecific</a></td><td>
            Searches for an access control rule that exactly matches the specified rule and, if found, removes it.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRule.htm">RemoveAuditRule</a></td><td>
            Searches for an audit control rule with the same user as the specified rule, and with compatible inheritance and propagation flags; if a compatible rule is found, the rights contained in the specified rule are removed from it.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRuleAll.htm">RemoveAuditRuleAll</a></td><td>
            Searches for all audit rules with the same user as the specified rule and, if found, removes them.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_RemoveAuditRuleSpecific.htm">RemoveAuditRuleSpecific</a></td><td>
            Searches for an audit rule that exactly matches the specified rule and, if found, removes it.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_ResetAccessRule.htm">ResetAccessRule</a></td><td>
            Removes all access control rules with the same user as the specified rule, regardless of <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.accesscontroltype" target="_blank" rel="noopener noreferrer">AccessControlType</a>, and then adds the specified rule.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_SetAccessRule.htm">SetAccessRule</a></td><td>
            Removes all access control rules with the same user and <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.accesscontroltype" target="_blank" rel="noopener noreferrer">AccessControlType</a> (allow or deny) as the specified rule, and then adds the specified rule.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_SetAuditRule.htm">SetAuditRule</a></td><td>
            Removes all audit rules with the same user as the specified rule, regardless of the <a href="https://learn.microsoft.com/dotnet/api/system.security.accesscontrol.auditflags" target="_blank" rel="noopener noreferrer">AuditFlags</a> value, and then adds the specified rule.
            </td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_Microsoft_Win32_TaskScheduler_TaskSecurity_ToString.htm">ToString</a></td><td>
            Returns a <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a> that represents this instance.
            <br />(Overrides <a href="https://learn.microsoft.com/dotnet/api/system.object.tostring" target="_blank" rel="noopener noreferrer">Object<span id="LST56B0D541_11" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>ToString<span id="LST56B0D541_12" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a>)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>A TaskSecurity object specifies access rights for a Task Scheduler task, and also specifies how access attempts are audited. Access rights to the task are expressed as rules, with each access rule represented by a <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a> object. Each auditing rule is represented by a <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> object.</p><p>This mirrors the underlying Windows security system, in which each securable object has at most one discretionary access control list (DACL) that controls access to the secured object, and at most one system access control list (SACL) that specifies which access attempts are audited. The DACL and SACL are ordered lists of access control entries (ACE) that specify access and auditing for users and groups. A <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a> or <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> object might represent more than one ACE.</p><p>Note</p><p>A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> object can represent a local task or a Task Scheduler task. Windows access control security is meaningful only for Task Scheduler tasks.</p><p>The TaskSecurity, <a href="T_Microsoft_Win32_TaskScheduler_TaskAccessRule.htm">TaskAccessRule</a>, and <a href="T_Microsoft_Win32_TaskScheduler_TaskAuditRule.htm">TaskAuditRule</a> classes hide the implementation details of ACLs and ACEs. They allow you to ignore the seventeen different ACE types and the complexity of correctly maintaining inheritance and propagation of access rights. These objects are also designed to prevent the following common access control errors:</p><ul><li>Creating a security descriptor with a null DACL. A null reference to a DACL allows any user to add access rules to an object, potentially creating a denial-of-service attack. A new TaskSecurity object always starts with an empty DACL, which denies all access for all users.</li><li>Violating the canonical ordering of ACEs. If the ACE list in the DACL is not kept in the canonical order, users might inadvertently be given access to the secured object. For example, denied access rights must always appear before allowed access rights. TaskSecurity objects maintain the correct order internally. </li><li>Manipulating security descriptor flags, which should be under resource manager control only.</li><li>Creating invalid combinations of ACE flags.</li><li>Manipulating inherited ACEs. Inheritance and propagation are handled by the resource manager, in response to changes you make to access and audit rules.</li><li>Inserting meaningless ACEs into ACLs.</li></ul><p>The only capabilities not supported by the .NET security objects are dangerous activities that should be avoided by the majority of application developers, such as the following:</p><ul><li>Low-level tasks that are normally performed by the resource manager.</li><li>Adding or removing access control entries in ways that do not maintain the canonical ordering.</li></ul><p>To modify Windows access control security for a task, use the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetAccessControl.htm">GetAccessControl<span id="LST56B0D541_13" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a> method to get the TaskSecurity object. Modify the security object by adding and removing rules, and then use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method to reattach it. </p><p>Important: Changes you make to a TaskSecurity object do not affect the access levels of the task until you call the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method to assign the altered security object to the task.</p><p>To copy access control security from one task to another, use the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetAccessControl.htm">GetAccessControl<span id="LST56B0D541_14" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a> method to get a TaskSecurity object representing the access and audit rules for the first task, then use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm">SetAccessControl(TaskSecurity)</a> method, or a constructor that accepts a TaskSecurity object, to assign those rules to the second task.</p><p>Users with an investment in the security descriptor definition language (SDDL) can use the <a href="M_Microsoft_Win32_TaskScheduler_Task_SetSecurityDescriptorSddlForm.htm">SetSecurityDescriptorSddlForm(String, TaskSetSecurityOptions)</a> method to set access rules for a task, and the <a href="M_Microsoft_Win32_TaskScheduler_Task_GetSecurityDescriptorSddlForm.htm">GetSecurityDescriptorSddlForm(SecurityInfos)</a> method to obtain a string that represents the access rules in SDDL format. This is not recommended for new development.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank" rel="noopener noreferrer">© 2024 GitHub Community. All rights reserved.</a></p></div></body></html>