<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TaskFolder.RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(System.String,Microsoft.Win32.TaskScheduler.TaskDefinition,Microsoft.Win32.TaskScheduler.TaskCreation,System.String,System.String,Microsoft.Win32.TaskScheduler.TaskLogonType,System.String)" /><meta name="Description" content="Registers (creates) a task in a specified location using a instance to define a task." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Overview" tocid="R_Project_TaskScheduler">Overview</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Class" tocid="T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition Method " tocid="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition Method (String, TaskDefinition)" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition Method (String, TaskDefinition)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1.htm" title="RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1">RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="Task Scheduler Managed Class Library" width="48" height="48" src="../icons/tsnew48.png" /></td><td class="titleColumn"><h1>TaskFolder<span id="LST7B3FF648_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_0?cpp=::|nu=.");</script>RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Registers (creates) a task in a specified location using a <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> instance to define a task.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br />
    <strong>Assembly:</strong>
   Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.7.1<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Task</span> <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">string</span> <span class="parameter">path</span>,
	<span class="identifier">TaskDefinition</span> <span class="parameter">definition</span>,
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>,
	<span class="identifier">string</span> <span class="parameter">userId</span>,
	<span class="identifier">string</span> <span class="parameter">password</span> = <span class="keyword">null</span>,
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	<span class="identifier">string</span> <span class="parameter">sddl</span> = <span class="keyword">null</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">RegisterTaskDefinition</span> ( 
	<span class="parameter">path</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">definition</span> <span class="keyword">As</span> <span class="identifier">TaskDefinition</span>,
	<span class="parameter">createType</span> <span class="keyword">As</span> <span class="identifier">TaskCreation</span>,
	<span class="parameter">userId</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	Optional <span class="parameter">password</span> <span class="keyword">As</span> <span class="identifier">String</span> = <span class="keyword">Nothing</span>,
	Optional <span class="parameter">logonType</span> <span class="keyword">As</span> <span class="identifier">TaskLogonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	Optional <span class="parameter">sddl</span> <span class="keyword">As</span> <span class="identifier">String</span> = <span class="keyword">Nothing</span>
) <span class="keyword">As</span> <span class="identifier">Task</span></pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Task</span>^ <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">String</span>^ <span class="parameter">path</span>, 
	<span class="identifier">TaskDefinition</span>^ <span class="parameter">definition</span>, 
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>, 
	<span class="identifier">String</span>^ <span class="parameter">userId</span>, 
	<span class="identifier">String</span>^ <span class="parameter">password</span> = <span class="keyword">nullptr</span>, 
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>::S4U, 
	<span class="identifier">String</span>^ <span class="parameter">sddl</span> = <span class="keyword">nullptr</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><a id="HT_RequestExampleLink" href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
		var HT_requestExampleLinkText = HT_requestExampleLink.innerHTML;
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=Task Scheduler Managed Class Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		HT_requestExampleLink.innerHTML = HT_requestExampleLinkText;
		</script><a target="_blank" class="button" href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/TaskFolder.cs" title="View the source code">View Source</a><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">path</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The task name. If this value is NULL, the task will be registered in the root task folder and the task name will be a GUID value that is created by the Task Scheduler service. A task name cannot begin or end with a space character. The '.' character cannot be used to specify the current task folder and the '..' characters cannot be used to specify the parent task folder in the path.</dd><dt><span class="parameter">definition</span></dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskDefinition</a><br />The <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> of the registered task.</dd><dt><span class="parameter">createType</span></dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskCreation</a><br />A union of <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a> flags.</dd><dt><span class="parameter">userId</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The user credentials used to register the task.</dd><dt><span class="parameter">password</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The password for the userId used to register the task.</dd><dt><span class="parameter">logonType</span> (Optional)</dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskLogonType</a><br />A <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a> value that defines what logon technique is used to run the registered task.</dd><dt><span class="parameter">sddl</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The security descriptor associated with the registered task. You can specify the access control list (ACL) in the security descriptor for a task in order to allow or deny certain users and groups access to a task.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a><br />
            A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> instance that represents the new task. This will return <span class="code">null</span> if <span class="parameter">createType</span> is set to <span class="code">ValidateOnly</span> and there are no validation errors.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_blank">ArgumentOutOfRangeException</a></td><td>
            Task names may not include any characters which are invalid for file names.
            or
            Task names ending with a period followed by three or fewer characters cannot be retrieved due to a bug in the native library.
            </td></tr><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>This LogonType is not supported on Task Scheduler 1.0.
            or
            Security settings are not available on Task Scheduler 1.0.
            or
            Registration triggers are not available on Task Scheduler 1.0.
            or
            XML validation not available on Task Scheduler 1.0.</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection">This method is effectively the "Save" method for tasks. It takes a modified <span class="code">TaskDefinition</span> instance and registers it in the folder defined by this <span class="code">TaskFolder</span> instance. Optionally, you can use this method to override the user, password and logon type defined in the definition and supply security against the task.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID4RBSection" class="collapsibleSection"><p>This first example registers a simple task with a single trigger and action using the default security.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAEABA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAEABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAEABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAEABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Create a new task definition for the local machine and assign properties</span>
TaskDefinition td = TaskService.Instance.NewTask();
td.RegistrationInfo.Description = <span class="highlight-literal">"Does something"</span>;

<span class="highlight-comment">// Add a trigger that, starting tomorrow, will fire every other week on Monday and Saturday</span>
td.Triggers.Add(<span class="highlight-keyword">new</span> WeeklyTrigger(DaysOfTheWeek.Monday | DaysOfTheWeek.Saturday, <span class="highlight-number">2</span>));

<span class="highlight-comment">// Create an action that will launch Notepad whenever the trigger fires</span>
td.Actions.Add(<span class="highlight-literal">"notepad.exe"</span>, <span class="highlight-literal">"c:\\test.log"</span>);

<span class="highlight-comment">// Register the task in the root folder of the local machine using the current user and the S4U logon type</span>
TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"Test"</span>, td);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAEABA");</script><p>This example registers that same task using the SYSTEM account.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACABA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"TaskName"</span>, taskDefinition, TaskCreation.CreateOrUpdate, <span class="highlight-literal">"SYSTEM"</span>, <span class="highlight-keyword">null</span>, TaskLogonType.ServiceAccount);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACABA");</script><p>This example registers that same task using a specific username and password along with a security definition.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"TaskName"</span>, taskDefinition, TaskCreation.CreateOrUpdate, <span class="highlight-literal">"userDomain\\userName"</span>, <span class="highlight-literal">"userPassword"</span>, TaskLogonType.Password, <span class="highlight-literal">@"O:BAG:DUD:(A;ID;0x1f019f;;;BA)(A;ID;0x1f019f;;;SY)(A;ID;FA;;;BA)(A;;FR;;;BU)"</span>);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID5RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm">TaskFolder Class</a></div><div class="seeAlsoStyle"><a href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm">RegisterTaskDefinition Overload</a></div><div class="seeAlsoStyle"><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank">© 2017 GitHub Community. All rights reserved.</a></p> </div></body></html>