<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>TaskFolder.RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String) Method</title><meta name="Title" content="RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String) Method" /><meta name="Microsoft.Help.Id" content="M:Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(System.String,Microsoft.Win32.TaskScheduler.TaskDefinition,Microsoft.Win32.TaskScheduler.TaskCreation,System.String,System.String,Microsoft.Win32.TaskScheduler.TaskLogonType,System.String)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Description" content="Registers (creates) a task in a specified location using a instance to define a task." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library Overview" tocid="R_Project_TaskScheduler">Task Scheduler Managed Class Library Overview</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Class" tocid="T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition Method" tocid="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition Method</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition(String, TaskDefinition) Method" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition(String, TaskDefinition) Method</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1.htm" title="RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String) Method" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1">RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String) Method</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="logoColumn"><a target="_blank" rel="noopener noreferrer" href="https://github.com/dahall/TaskScheduler"><img alt="Task Scheduler Managed Class Library" width="48" height="48" src="../icons/tsnew48.png" /></a></td><td class="titleColumn"><h1>Task<wbr />Folder<span id="LST7B3FF648_0" data-languageSpecificText="cpp=::|nu=."></span>Register<wbr />Task<wbr />Definition(String, Task<wbr />Definition, Task<wbr />Creation, String, String, Task<wbr />Logon<wbr />Type, String) Method</h1></td></tr></table><div class="summary">
            Registers (creates) a task in a specified location using a <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> instance to define a task.
            </div><br /><strong>Namespace:</strong> <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br /><strong>Assembly:</strong> Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.11.1<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Task</span> <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">string</span> <span class="parameter">path</span>,
	<span class="identifier">TaskDefinition</span> <span class="parameter">definition</span>,
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>,
	<span class="identifier">string</span> <span class="parameter">userId</span>,
	<span class="identifier">string</span> <span class="parameter">password</span> = <span class="keyword">null</span>,
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	<span class="identifier">string</span> <span class="parameter">sddl</span> = <span class="keyword">null</span>
)</pre></div></div></div><a id="HT_RequestExampleLink" href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" rel="noopener noreferrer" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=Task%20Scheduler%20Managed%20Class%20Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		</script><a target="_blank" class="button" href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/TaskFolder.cs#L480" rel="noopener noreferrer" title="View the source code">View Source</a><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">path</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The task name. If this value is NULL, the task will be registered in the root task folder and the task name will be a GUID value that is created by the Task Scheduler service. A task name cannot begin or end with a space character. The '.' character cannot be used to specify the current task folder and the '..' characters cannot be used to specify the parent task folder in the path.</dd><dt class="has-text-weight-normal"><span class="parameter">definition</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a></dt><dd>The <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> of the registered task.</dd><dt class="has-text-weight-normal"><span class="parameter">createType</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a></dt><dd>A union of <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a> flags.</dd><dt class="has-text-weight-normal"><span class="parameter">userId</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The user credentials used to register the task.</dd><dt class="has-text-weight-normal"><span class="parameter">password</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a>  (Optional)</dt><dd>The password for the userId used to register the task.</dd><dt class="has-text-weight-normal"><span class="parameter">logonType</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a>  (Optional)</dt><dd>A <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a> value that defines what logon technique is used to run the registered task.</dd><dt class="has-text-weight-normal"><span class="parameter">sddl</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a>  (Optional)</dt><dd>The security descriptor associated with the registered task. You can specify the access control list (ACL) in the security descriptor for a task in order to allow or deny certain users and groups access to a task.</dd></dl><h4>Return Value</h4><a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a><br />
            A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> instance that represents the new task. This will return <span class="code">null</span> if <span class="parameter">createType</span> is set to <span class="code">ValidateOnly</span> and there are no validation errors.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDJC')" onkeypress="SectionExpandCollapse_CheckKey('IDJC', event)" tabindex="0"><img id="IDJCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDJCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.argumentoutofrangeexception" target="_blank" rel="noopener noreferrer">ArgumentOutOfRangeException</a></td><td>
            Task names may not include any characters which are invalid for file names.
            or
            Task names ending with a period followed by three or fewer characters cannot be retrieved due to a bug in the native library.
            </td></tr><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>This LogonType is not supported on Task Scheduler 1.0.
            or
            Security settings are not available on Task Scheduler 1.0.
            or
            Registration triggers are not available on Task Scheduler 1.0.
            or
            XML validation not available on Task Scheduler 1.0.</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDLC')" onkeypress="SectionExpandCollapse_CheckKey('IDLC', event)" tabindex="0"><img id="IDLCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDLCSection" class="collapsibleSection">This method is effectively the "Save" method for tasks. It takes a modified <span class="code">TaskDefinition</span> instance and registers it in the folder defined by this <span class="code">TaskFolder</span> instance. Optionally, you can use this method to override the user, password and logon type defined in the definition and supply security against the task.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDMC')" onkeypress="SectionExpandCollapse_CheckKey('IDMC', event)" tabindex="0"><img id="IDMCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDMCSection" class="collapsibleSection"><p>This first example registers a simple task with a single trigger and action using the default security.</p><div id="IDBMC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDBMC_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDBMC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDBMC');return false;" title="Copy">Copy</a></div></div><div id="IDBMC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Create a new task definition for the local machine and assign properties</span>
TaskDefinition td = TaskService.Instance.NewTask();
td.RegistrationInfo.Description = <span class="highlight-literal">"Does something"</span>;

<span class="highlight-comment">// Add a trigger that, starting tomorrow, will fire every other week on Monday and Saturday</span>
td.Triggers.Add(<span class="highlight-keyword">new</span> WeeklyTrigger(DaysOfTheWeek.Monday | DaysOfTheWeek.Saturday, <span class="highlight-number">2</span>));

<span class="highlight-comment">// Create an action that will launch Notepad whenever the trigger fires</span>
td.Actions.Add(<span class="highlight-literal">"notepad.exe"</span>, <span class="highlight-literal">"c:\\test.log"</span>);

<span class="highlight-comment">// Register the task in the root folder of the local machine using the current user and the S4U logon type</span>
TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"Test"</span>, td);</pre></div></div></div><p>This example registers that same task using the SYSTEM account.</p><div id="IDDMC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDDMC_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDDMC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDDMC');return false;" title="Copy">Copy</a></div></div><div id="IDDMC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"TaskName"</span>, taskDefinition, TaskCreation.CreateOrUpdate, <span class="highlight-literal">"SYSTEM"</span>, <span class="highlight-keyword">null</span>, TaskLogonType.ServiceAccount);</pre></div></div></div><p>This example registers that same task using a specific username and password along with a security definition.</p><div id="IDFMC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDFMC_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDFMC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDFMC');return false;" title="Copy">Copy</a></div></div><div id="IDFMC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">TaskService.Instance.RootFolder.RegisterTaskDefinition(<span class="highlight-literal">"TaskName"</span>, taskDefinition, TaskCreation.CreateOrUpdate, <span class="highlight-literal">"userDomain\\userName"</span>, <span class="highlight-literal">"userPassword"</span>, TaskLogonType.Password, <span class="highlight-literal">@"O:BAG:DUD:(A;ID;0x1f019f;;;BA)(A;ID;0x1f019f;;;SY)(A;ID;FA;;;BA)(A;;FR;;;BU)"</span>);</pre></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm">TaskFolder Class</a></div><div><a href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm">RegisterTaskDefinition Overload</a></div><div><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank" rel="noopener noreferrer">© 2024 GitHub Community. All rights reserved.</a></p></div></body></html>