<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Task.RunEx Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="RunEx method" /><meta name="System.Keywords" content="Task.RunEx method" /><meta name="Microsoft.Help.F1" content="Microsoft.Win32.TaskScheduler.Task.RunEx" /><meta name="Microsoft.Help.Id" content="M:Microsoft.Win32.TaskScheduler.Task.RunEx(Microsoft.Win32.TaskScheduler.TaskRunFlags,System.Int32,System.String,System.String[])" /><meta name="Description" content="Runs the registered task immediately using specified flags and a session identifier." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="M_Microsoft_Win32_TaskScheduler_Task_RunEx" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_Task_RunEx" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library Overview" tocid="R_Project_TaskScheduler">Task Scheduler Managed Class Library Overview</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Microsoft_Win32_TaskScheduler_Task.htm" title="Task Class" tocid="T_Microsoft_Win32_TaskScheduler_Task">Task Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Microsoft_Win32_TaskScheduler_Task.htm" title="Task Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_Task">Task Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_CompareTo.htm" title="CompareTo Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_CompareTo">CompareTo Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_Dispose.htm" title="Dispose Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_Dispose">Dispose Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_Export.htm" title="Export Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_Export">Export Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Microsoft_Win32_TaskScheduler_Task_GetAccessControl.htm" title="GetAccessControl Method " tocid="Overload_Microsoft_Win32_TaskScheduler_Task_GetAccessControl">GetAccessControl Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_GetInstances.htm" title="GetInstances Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_GetInstances">GetInstances Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_GetLastRegistrationTime.htm" title="GetLastRegistrationTime Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_GetLastRegistrationTime">GetLastRegistrationTime Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_GetRunTimes.htm" title="GetRunTimes Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_GetRunTimes">GetRunTimes Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_GetSecurityDescriptorSddlForm.htm" title="GetSecurityDescriptorSddlForm Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_GetSecurityDescriptorSddlForm">GetSecurityDescriptorSddlForm Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_RegisterChanges.htm" title="RegisterChanges Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_RegisterChanges">RegisterChanges Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_Run.htm" title="Run Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_Run">Run Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_RunEx.htm" title="RunEx Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_RunEx">RunEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl.htm" title="SetAccessControl Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_SetAccessControl">SetAccessControl Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_SetSecurityDescriptorSddlForm.htm" title="SetSecurityDescriptorSddlForm Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_SetSecurityDescriptorSddlForm">SetSecurityDescriptorSddlForm Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_ShowEditor.htm" title="ShowEditor Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_ShowEditor">ShowEditor Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_ShowPropertyPage.htm" title="ShowPropertyPage Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_ShowPropertyPage">ShowPropertyPage Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_Stop.htm" title="Stop Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_Stop">Stop Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Microsoft_Win32_TaskScheduler_Task_ToString.htm" title="ToString Method " tocid="M_Microsoft_Win32_TaskScheduler_Task_ToString">ToString Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="Task Scheduler Managed Class Library" width="48" height="48" src="../icons/tsnew48.png" /></td><td class="titleColumn"><h1>Task<span id="LSTB9A3EB02_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_0?cpp=::|nu=.");</script>RunEx Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">Runs the registered task immediately using specified flags and a session identifier.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br />
    <strong>Assembly:</strong>
   Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.8.21<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">RunningTask</span> <span class="identifier">RunEx</span>(
	<span class="identifier">TaskRunFlags</span> <span class="parameter">flags</span>,
	<span class="identifier">int</span> <span class="parameter">sessionID</span>,
	<span class="identifier">string</span> <span class="parameter">user</span>,
	<span class="keyword">params</span> <span class="identifier">string</span>[] <span class="parameter">parameters</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">RunEx</span> ( 
	<span class="parameter">flags</span> <span class="keyword">As</span> <span class="identifier">TaskRunFlags</span>,
	<span class="parameter">sessionID</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">user</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="keyword">ParamArray</span> <span class="parameter">parameters</span> <span class="keyword">As</span> <span class="identifier">String</span>()
) <span class="keyword">As</span> <span class="identifier">RunningTask</span></pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">RunningTask</span>^ <span class="identifier">RunEx</span>(
	<span class="identifier">TaskRunFlags</span> <span class="parameter">flags</span>, 
	<span class="identifier">int</span> <span class="parameter">sessionID</span>, 
	<span class="identifier">String</span>^ <span class="parameter">user</span>, 
	... <span class="keyword">array</span>&lt;<span class="identifier">String</span>^&gt;^ <span class="parameter">parameters</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><a id="HT_RequestExampleLink" href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
		var HT_requestExampleLinkText = HT_requestExampleLink.innerHTML;
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=Task%20Scheduler%20Managed%20Class%20Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		HT_requestExampleLink.innerHTML = HT_requestExampleLinkText;
		</script><a target="_blank" class="button" href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/Task.cs" title="View the source code">View Source</a><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">flags</span></dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">Microsoft.Win32.TaskScheduler<span id="LSTB9A3EB02_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskRunFlags</a><br />Defines how the task is run.</dd><dt><span class="parameter">sessionID</span></dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank">System<span id="LSTB9A3EB02_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br /><p>The terminal server session in which you want to start the task.</p><p>
            If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is not passed into the <span class="parameter">flags</span> parameter, then the value specified in this
            parameter is ignored.If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the flags parameter and the sessionID value is less than or
            equal to 0, then an invalid argument error will be returned.
            </p><p>
            If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the <span class="parameter">flags</span> parameter and the sessionID value is a valid session
            ID greater than 0 and if no value is specified for the user parameter, then the Task Scheduler service will try to start the task interactively as
            the user who is logged on to the specified session.
            </p><p>
            If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the <span class="parameter">flags</span> parameter and the sessionID value is a valid session
            ID greater than 0 and if a user is specified in the user parameter, then the Task Scheduler service will try to start the task interactively as the
            user who is specified in the user parameter.
            </p></dd><dt><span class="parameter">user</span></dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.string" target="_blank">System<span id="LSTB9A3EB02_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The user for which the task runs.</dd><dt><span class="parameter">parameters</span></dt><dd>Type: <span id="LSTB9A3EB02_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_4?cpp=array&lt;");</script><a href="https://docs.microsoft.com/dotnet/api/system.string" target="_blank">System<span id="LSTB9A3EB02_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><span id="LSTB9A3EB02_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB9A3EB02_6?cpp=&gt;|vb=()|nu=[]");</script><br /><p>
            The parameters used as values in the task actions. A maximum of 32 parameters can be supplied. To run a task with no parameters,
            call this method without any values (e.g. <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABDEBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EABDEBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABDEBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">RunEx(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-literal">"MyUserName"</span>)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABDEBA");</script>).
            </p><p>
            The string values that you specify are paired with names and stored as name-value pairs. If you specify a single string value,
            then Arg0 will be the name assigned to the value. The value can be used in the task action where the $(Arg0) variable is used in
            the action properties.
            </p><p>
            If you pass in values such as "0", "100", and "250" as an array of string values, then "0" will replace the $(Arg0) variables,
            "100" will replace the $(Arg1) variables, and "250" will replace the $(Arg2) variables used in the action properties.
            </p><p>
            For more information and a list of action properties that can use $(Arg0), $(Arg1), ..., $(Arg32) variables in their values, see
            <a href="https://docs.microsoft.com/en-us/windows/desktop/taskschd/task-actions#using-variables-in-action-properties">Task Actions</a>.
            </p></dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_Microsoft_Win32_TaskScheduler_RunningTask.htm">RunningTask</a><br />A <a href="T_Microsoft_Win32_TaskScheduler_RunningTask.htm">RunningTask</a> instance that defines the new instance of the task.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>Not supported under Task Scheduler 1.0.</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
            This method will return without error, but the task will not run if the AllowDemandStart property of ITaskSettings is set to false for the task.
            </p><p>If RunEx is invoked from a disabled task, it will return <span class="code">null</span> and the task will not be run.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID4RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Run the current task with a parameter as a different user and ignoring any of the conditions.</span>
<span class="highlight-keyword">var</span> runningTask = myTaskInstance.RunEx(TaskRunFlags.IgnoreConstraints, <span class="highlight-number">0</span>, <span class="highlight-literal">"DOMAIN\\User"</span>, <span class="highlight-literal">"info"</span>);
Console.Write(<span class="highlight-keyword">string</span>.Format(<span class="highlight-literal">"Running task's current action is {0}."</span>, runningTask.CurrentAction));</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID5RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task Class</a></div><div class="seeAlsoStyle"><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank">© 2020 GitHub Community. All rights reserved.</a></p> </div></body></html>